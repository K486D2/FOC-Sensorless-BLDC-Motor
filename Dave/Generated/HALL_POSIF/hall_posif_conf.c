/*********************************************************************************************************************
* DAVE APP Name : HALL_POSIF       APP Version: 4.0.10
*
* NOTE:
* This file is generated by DAVE. Any manual modification done to this file will be lost when the code is regenerated.
*********************************************************************************************************************/

/**
 * @cond
 ***********************************************************************************************************************
 *
 * Copyright (c) 2015-2020, Infineon Technologies AG
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,are permitted provided that the
 * following conditions are met:
 *
 *   Redistributions of source code must retain the above copyright notice, this list of conditions and the  following
 *   disclaimer.
 *
 *   Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the
 *   following disclaimer in the documentation and/or other materials provided with the distribution.
 *
 *   Neither the name of the copyright holders nor the names of its contributors may be used to endorse or promote
 *   products derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES,
 * INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE  FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 * SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
 * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY,OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT  OF THE
 * USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * To improve the quality of the software, users are encouraged to share modifications, enhancements or bug fixes
 * with Infineon Technologies AG (dave@infineon.com).
 ***********************************************************************************************************************
 *
 * Change History
 * --------------
 *
 * 2015-02-20:
 *     - Initial version
 *
 * 2015-06-20:
 *     - ERU initialization modified
 *
 * 2019-11-26:
 *     - CCU4 inputs adaptations for XMC14
 *
 * @endcond
 *
 */
/***********************************************************************************************************************
 * HEADER FILES
 **********************************************************************************************************************/
#include "hall_posif.h"
/**********************************************************************************************************************
* DATA STRUCTURES
**********************************************************************************************************************/

XMC_GPIO_CONFIG_t HALL_POSIF_0_Hall_PadConfig  =
{
  .mode            = (XMC_GPIO_MODE_t)XMC_GPIO_MODE_INPUT_TRISTATE,
  .output_level    = (XMC_GPIO_OUTPUT_LEVEL_t)XMC_GPIO_OUTPUT_LEVEL_LOW,
  
  .input_hysteresis= 0
  
};

HALL_POSIF_GPIO_t HALL_POSIF_0_H3_PadResource =
{
  .port = XMC_GPIO_PORT1,
  .pin  = 0U
};

HALL_POSIF_GPIO_t HALL_POSIF_0_H2_PadResource =
{
  .port = XMC_GPIO_PORT1,
  .pin  = 1U
};
HALL_POSIF_GPIO_t HALL_POSIF_0_H1_PadResource =
{
  .port = XMC_GPIO_PORT1,
  .pin  = 2U
};
/* Configure the ccu4 timer structure use for phase delay */
XMC_CCU4_SLICE_COMPARE_CONFIG_t HALL_POSIF_0_phdelaytimer_init =
{
  .timer_mode          = XMC_CCU4_SLICE_TIMER_COUNT_MODE_EA,        
  .monoshot            = 1,      
  .shadow_xfer_clear   = 1,  
  .dither_timer_period = 0,   
  .dither_duty_cycle   = 0, 
  .prescaler_mode      = XMC_CCU4_SLICE_PRESCALER_MODE_NORMAL,  
  .mcm_enable          = 0,
  .prescaler_initval   = 6U,
  .float_limit         = 0U,          
  .dither_limit        = 0U,          
  .passive_level       = XMC_CCU4_SLICE_OUTPUT_PASSIVE_LEVEL_LOW,    
  .timer_concatenation = 0
};

XMC_CCU4_SLICE_EVENT_CONFIG_t HALL_POSIF_0_phdelay_eventconfig =
{
  .mapped_input = XMC_CCU4_SLICE_INPUT_AE, 
  .edge         = XMC_CCU4_SLICE_EVENT_EDGE_SENSITIVITY_RISING_EDGE,          
  .level        = XMC_CCU4_SLICE_EVENT_LEVEL_SENSITIVITY_ACTIVE_HIGH,         
  .duration     = XMC_CCU4_SLICE_EVENT_FILTER_DISABLED   
};

XMC_CCU4_SLICE_EVENT_CONFIG_t HALL_POSIF_0_capture_eventconfig =
{
  .mapped_input = XMC_CCU4_SLICE_INPUT_BD, 
  .edge         = XMC_CCU4_SLICE_EVENT_EDGE_SENSITIVITY_RISING_EDGE,          
  .level        = XMC_CCU4_SLICE_EVENT_LEVEL_SENSITIVITY_ACTIVE_HIGH,         
  .duration     = XMC_CCU4_SLICE_EVENT_FILTER_DISABLED      
};

XMC_CCU4_SLICE_CAPTURE_CONFIG_t HALL_POSIF_0_capture_init =
{
  .timer_clear_mode    = XMC_CCU4_SLICE_TIMER_CLEAR_MODE_CAP_HIGH,
  .same_event          = 0,       
  .fifo_enable         = 0,           
  .ignore_full_flag    = 0 
};

HALL_POSIF_CCU4_SLICE_t HALL_POSIF_0_phasedelay =
{
  .slice_ptr           = (CCU4_CC4_TypeDef*)(void*)CCU40_CC40,  
  .module_ptr          = (CCU4_GLOBAL_TypeDef*)(void*) CCU40_BASE,  
  .shadow_transfer_msk = (uint32_t)XMC_CCU4_SHADOW_TRANSFER_SLICE_0,
  .slice_number        = (uint8_t)0 
}; 
 
HALL_POSIF_CCU4_SLICE_t HALL_POSIF_0_capture =
{
  .slice_ptr           = (CCU4_CC4_TypeDef*)(void*)CCU40_CC43,  
  .module_ptr          = (CCU4_GLOBAL_TypeDef*)(void*) CCU40_BASE, 
  .shadow_transfer_msk = (uint32_t)XMC_CCU4_SHADOW_TRANSFER_SLICE_3,  
  .slice_number          = (uint8_t)3
  
}; 
 
XMC_POSIF_HSC_CONFIG_t HALL_POSIF_0_InitHandle =
{
  .disable_idle_signal    = true,  
  .sampling_trigger       = XMC_POSIF_INPUT_PORT_A, 
  .sampling_trigger_edge  = XMC_POSIF_HSC_TRIGGER_EDGE_RISING,     
  .external_error_port    = XMC_POSIF_INPUT_PORT_A, 
  .external_error_enable  = 0,   
  .external_error_level   = XMC_POSIF_INPUT_ACTIVE_LEVEL_HIGH 
};
XMC_POSIF_CONFIG_t HALL_POSIF_0_PosifConf =
{
  .mode   = XMC_POSIF_MODE_HALL_SENSOR,    /**< POSIF Operational mode */
  .input0 = XMC_POSIF_INPUT_PORT_A,    /**< Choice of input for Input-1 */
  .input1 = XMC_POSIF_INPUT_PORT_A,    /**< Choice of input for Input-2 */
  .input2 = XMC_POSIF_INPUT_PORT_A,   /**< Choice of input for Input-3 */
  .filter = XMC_POSIF_FILTER_DISABLED   /**< Input filter configuration */
};
HALL_POSIF_Config_t HALL_POSIF_0_Config =
{
  .capture_slice_sr     = {
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0
                          },
  .phasedelay_slice_sr  = {
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0,
                            XMC_CCU4_SLICE_SR_ID_0
                          },
  .posif_hsc_sr         = {
                            XMC_POSIF_SR_ID_0,
                            XMC_POSIF_SR_ID_0,
                            XMC_POSIF_SR_ID_0
                          },
  .halltype             = HALL_POSIF_3HALL,
  .phase_delay_const    = 546U,
  .blanking_time        = 8U,
  .phase_delay          = 13U,
  .speed_constant_avg   = 89999997U,
  .enable_eru           = {
                            0U,
                            0U,
                            0U
                          },
  .interrupt_enable     = 0x0U,
  .hall3pin             = 0x00U
};
HALL_POSIF_t HALL_POSIF_0 =
{
  .captureval             = {0U},
  .hall_pattern           = {
                            (uint8_t)HALL_POSIF_MCM(0,0),(uint8_t)HALL_POSIF_MCM(3,1),(uint8_t)HALL_POSIF_MCM(6,2),(uint8_t)HALL_POSIF_MCM(2,3),
                            (uint8_t)HALL_POSIF_MCM(5,4),(uint8_t)HALL_POSIF_MCM(1,5),(uint8_t)HALL_POSIF_MCM(4,6),(uint8_t)HALL_POSIF_MCM(0,0),
                            (uint8_t)HALL_POSIF_MCM(0,0),(uint8_t)HALL_POSIF_MCM(5,1),(uint8_t)HALL_POSIF_MCM(3,2),(uint8_t)HALL_POSIF_MCM(1,3),
                            (uint8_t)HALL_POSIF_MCM(6,4),(uint8_t)HALL_POSIF_MCM(4,5),(uint8_t)HALL_POSIF_MCM(2,6),(uint8_t)HALL_POSIF_MCM(0,0)
                          },
  .hallinput_ptr          = {
                              &HALL_POSIF_0_H1_PadResource,
                              &HALL_POSIF_0_H2_PadResource,

                              &HALL_POSIF_0_H3_PadResource,

                            },
  #if (HALL_POSIF_ERU_AVALABLE == 1U)
  .etl_conf_ptr			  = {NULL,
                             NULL,
                             NULL
                            },
  .etl_resource_ptr		  = {NULL,
                             NULL,
                             NULL
                            },
  .ogu_conf_ptr			  = {NULL,
                             NULL,
                             NULL
                            },
  #endif  
  .capture_init_ptr       = &HALL_POSIF_0_capture_init,
  .phasedelay_init_ptr    = &HALL_POSIF_0_phdelaytimer_init,                          
  .global_ptr             = (POSIF_GLOBAL_TypeDef*)(void*)POSIF0,
  .config_ptr             = &HALL_POSIF_0_Config,
  .posifhsc_ptr           = &HALL_POSIF_0_InitHandle,
  .posifconfig_ptr        = &HALL_POSIF_0_PosifConf,
  .phasedelay_ptr         = &HALL_POSIF_0_phasedelay,
  .capture_ptr            = &HALL_POSIF_0_capture,
  .phdelayevent_ptr       = &HALL_POSIF_0_phdelay_eventconfig,
  .captureevent_ptr       = &HALL_POSIF_0_capture_eventconfig,
  .hallpinconfig_ptr      = &HALL_POSIF_0_Hall_PadConfig,
  .global_posif_handle_ptr = &GLOBAL_POSIF_0,
  .global_ccu4_handle_ptr  = &GLOBAL_CCU4_0,
  .direction              = HALL_POSIF_CLK_DIR,
  .pattern_update_delay   = 83U,
  .speedcheck             = 0U,
  .timercheck             = 0U,
  .phadvance              = HALL_POSIF_PHASEADVANCE_DISABLE,
  .speedaccum             = 0U,
  .capval                 = 0x7FFFU,
  .state                  = HALL_POSIF_UNINITIALISED,

  .phaseconst             = 546U,
  .phaseadvconst          = 0U,

  .index                  = 0U,
  .speedindex             = 0U
};


